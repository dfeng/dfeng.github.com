/* 
 * Filters
 * author: Marcin Dziewulski
 * web: http://www.jscraft.net
 * email: info@jscraft.net
 * license: http://www.jscraft.net/licensing.html
 */
(function(d){d.fn.filters=function(h){var f={filter:{name:"filter",element:"a",active:"active"},container:{name:"container",element:"li"},css3:{init:!0,children:"a",property:"all 1s ease",transform:{scale:"0"}},move:{init:!0,easing:"linear",duration:500},fade:{duration:[500,500],opacity:[0,1]},fixed:!1,onclick:function(){}},c=d.extend(!0,f,h);return this.each(function(){var e=d(this),h=e.find("."+c.filter.name);C=e.find("."+c.container.name);P={init:function(){this._globals.init();this._height.update(L); c.css3.init&&this._css3.init();this._elements.init();this._collection.init();this.events.init()},_globals:{init:function(){f={w:e.width(),h:e.height()};A=h.find(c.filter.element);E=C.find(c.container.element);ED={w:E.outerWidth(!0),h:E.outerHeight(!0)};L=E.length;CSS3=c.css3;MOVE=c.move;FIXED=c.fixed;FADE=c.fade;POS=[];COL=[];COLUMN=Math.floor(f.w/ED.w);if(d.browser.msie&&10>Math.ceil(d.browser.version))CSS3.init=!1}},_height:{update:function(a){a=Math.ceil(a/COLUMN);C.css({height:ED.h*a})}},_css3:{init:function(){var a= c.css3.property,a={"-webkit-transition":a,"-moz-transition":a,"-o-transition":a,transition:a};E.children().css(a)},transform:function(a){var b=[],a=d.extend({},this.css,a);for(i in a)b.push(i+"("+a[i]+")");b=b.join(" ");return{"-webkit-transform":b,"-moz-transform":b,"-o-transform":b,transform:b}},reset:function(){return this.transform(this.css)},css:{scale:"1",rotate:"0",translate:"0, 0",skew:"0"}},_elements:{init:function(){this.position();this.css()},css:function(){E.css({position:"absolute",overflow:"hidden", display:"block"})},position:function(){E.each(function(){var a=d(this),b=a.position(),b={top:b.top,left:b.left,zIndex:1};POS.push(b);a.css(b)})}},_collection:{init:function(){this.add()},add:function(){A.each(function(){var a=d(this).attr("rel");"undefined"!=typeof a&&(a=E.filter("."+a),COL.push(a))})},position:function(){for(i in COL){var a=-1,b=-1;COL[i].each(function(c){var g=d(this);b++;0==c%COLUMN&&(a++,b=0);var c=ED.h*a,e=e=ED.w*b;g.animate({top:c,left:e},MOVE.duration,MOVE.easing)})}}},_transition:{element:function(a, b){if(CSS3.init){var c=P._css3.transform(CSS3.transform),d=P._css3.reset();b.children(CSS3.children).css(c);a.children(CSS3.children).css(d)}else b.stop(!0,!0).fadeTo(FADE.duration[0],FADE.opacity[0]),a.stop(!0,!0).fadeTo(FADE.duration[1],FADE.opacity[1]);MOVE.init&&P._collection.position()},all:function(){if(CSS3.init){var a=P._css3.reset();E.children(CSS3.children).css(a)}else E.fadeTo(FADE.duration[1],FADE.opacity[1])}},events:{init:function(){this.click()},click:function(){A.click(function(){var a= d(this),b=a.attr("rel"),e=c.filter.active;if("all"==b)MOVE.init?E.each(function(a){d(this).animate(POS[a],MOVE.duration,MOVE.easing,P._transition.all)}):P._transition.all(),!FIXED&&MOVE.init&&P._height.update(L);else{var g=E.filter("."+b),b=E.not(g),h=g.length,f={zIndex:10};g.css(f);f.zIndex=1;b.css(f);!FIXED&&MOVE.init&&P._height.update(h);P._transition.element(g,b)}A.removeClass(e);a.addClass(e);c.onclick.call(this,a,g||E);return!1})}}};P.init()})}})(jQuery);