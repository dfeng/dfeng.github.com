<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>{{ page.title }}</title>
    {% if page.description %}<meta name="description" content="{{ page.description }}">{% endif %}
    <meta name="author" content="{{ site.author.name }}">
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="{{ ASSET_PATH }}/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ ASSET_PATH }}/css/style.css" rel="stylesheet" type="text/css" media="all">
    {% if page.title == "dfeng" %}
    <link href="{{ ASSET_PATH }}/css/index.header.css" rel="stylesheet" type="text/css" media="all">
    {% else %}
    <link href="{{ ASSET_PATH }}/css/header.css" rel="stylesheet" type="text/css" media="all">
    {% endif %}
    <link href="{{ ASSET_PATH }}/css/pygments.css" rel="stylesheet" type="text/css" media="all">
    <link href="{{ ASSET_PATH }}/css/font.css" rel="stylesheet" type="text/css">
    <style type="text/css">
    code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit; color: inherit;}
    #header {background-image: url({{ ASSET_PATH}}/img/back.jpg);}
    </style>
    <script type="text/javascript" src="{{ ASSET_PATH }}/js/jquery.min.js"></script>
    <script src="{{ ASSET_PATH }}/js/filters.min.js" type="text/javascript"></script>
    <script src="{{ ASSET_PATH }}/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="{{ ASSET_PATH }}/js/jquery.infinitescroll.min.js" type="text/javascript"></script>
    <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <script type="text/javascript">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    });
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
    (function($)
    {
      $(document).ready(function(){
        var height = $(window).height();
        $("body > .container").css("min-height",height);
        {% if page.title == "dfeng" %}
        $(window).scroll(function(){
          var scroll = $(window).scrollTop();
          x = 450;
          $("#title-big").css("opacity", 1-scroll/x);
          $("#header").css("height",Math.max(x-scroll,85));
          $("#title-big").css("margin-top", -scroll/3);
          $("#title-small").css("opacity", scroll/100-2.5);
          $("#sidebar").css("top",Math.max(x+25-scroll,110));
        });
        $(".posts").infinitescroll({
          loading: {
            msgText: "",
            finished: function(){MathJax.Hub.Queue(["Typeset",MathJax.Hub])},
            finishedMsg: "",
            img: "{{ ASSET_PATH }}/img/spacer.gif"
          },
          nextSelector: "ul.pager a:first",
          navSelector: "ul.pager",
          itemSelector: ".posts div.post"
        });
        {% endif %}
        $("img[alt]")
          .wrap("<div class='photo'>")
          .after("<div class='icon'><img src='{{ ASSET_PATH }}/img/info-icon.png'></div>")
          .parent()
          .on("hover", function(){$(this).children(".icon").toggle()});
        $("img[alt]").each(function(){
          cameraData = $(this).attr("alt").split(",");
          $(this).siblings(".icon").data("title",["<div class='camera'><span class='exiflabel'>camera</span>",cameraData[0],"</div><div class='cameraProperty'><span class='exiflabel'>iso</span>",cameraData[1],"</div><div class='cameraProperty'><span class='exiflabel'>aperture</span>",cameraData[2],"</div><div class='cameraProperty'><span class='exiflabel'>exposure</span>",cameraData[3],"</div><div class='cameraProperty'><span class='exiflabel'>focal length</span>",cameraData[4],"</span></div>"].join(""));
        });
        $(".photo").tooltip({
          selector: ".icon",
          placement: "bottom"
        })
      });
    })(jQuery);
    </script>
  </head>
  <body>
    <div class="container">
      <div id="header">
        {% if page.title == "dfeng" %}
        <div id="title-big">
          <h1>
            <a href="/">{{ site.title }}</a>
          </h1>
          <h2 id="tagline">{{ site.tagline }}</h2>
        </div>
      {% endif %}
        <h1 id="title-small">
          <a href="/">{{ site.title }}</a>
        </h1>
      </div>
      <div class="content">
        {{ content }}
      </div>
      <div id="sidebar">
        <ul id="sidebar-icons">
          {% for node in site.pages %}
            {% if 'navigation' == node.group %}
              <li><a href="{{ node.url }}"><i class="icon-{{ node.icon }}"></i></a></li>
            {% endif %}
          {% endfor %}
          <li><a href="#"><i class="icon-heart"></i></a></li>
        </ul>
      </div>
    </div> <!-- /container -->
    {% include JB/analytics %}
  </body>
</html>
