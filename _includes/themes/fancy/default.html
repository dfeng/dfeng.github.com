<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>{{ page.title }}</title>
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href='http://fonts.googleapis.com/css?family=Playfair+Display:400italic|Varela+Round' rel='stylesheet' type='text/css'>
    <link href="{{ ASSET_PATH }}/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ ASSET_PATH }}/css/style.css" rel="stylesheet" type="text/css" media="all">
    <link href="{{ ASSET_PATH }}/css/font.css" rel="stylesheet" type="text/css" media="all">
    <link href="{{ ASSET_PATH }}/css/pygment.css" rel="stylesheet" type="text/css" media="all">
    <style type="text/css">
    code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit; color: inherit;}
    </style>
    <script type="text/javascript" src="{{ ASSET_PATH }}/js/jquery.min.js"></script>
    <script type="text/javascript" src="{{ ASSET_PATH }}/bootstrap/js/bootstrap.min.js"></script>
    <script src="{{ ASSET_PATH }}/js/filters.min.js" type="text/javascript"></script>
    <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <script type="text/javascript">
    MathJax.Hub.Config({
      TeX: { equationNumbers: { autoNumber: "AMS" } },
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    });
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
    $(document).ready(function(){
      // fix margins of posts with big pictures
      $('.big-picture > *:not(:has(img))').css({
        "width": "600px",
        "margin-left": "auto",
        "margin-right": "auto"
      });
      $('.big-quote > *:not(blockquote)').css({
        "width": "600px",
        "margin-left": "auto",
        "margin-right": "auto"
      });
      // audio tags
      $('a[href$=".mp3"]').each(function(){
        $(this).replaceWith("<audio><source src='"+$(this).attr("href")+"' type='audio/mpeg'></source></audio><a class='audio' href='play'><i class='icon-play'></i></a>");
      });
      $('.audio').on('click', function(e){
        e.preventDefault();
        audio = $(this).prev().get(0);
        if (audio.paused) {
          audio.play();
        } else {
          audio.pause();
        }
      });
      $('audio').on('play',function() {
        $(this).next().children(0).attr('class', 'icon-pause');
      }).on('pause ended', function() {
        $(this).next().children(0).attr('class', 'icon-play');    
      });
      // carousel js
      $(".post").each(function(i){
        if ($("img").length > 1) {
          $("img", this).wrap("<div class='item'>")
          $(".item", this).eq(0).addClass("active").end().wrapAll("<div class='carousel slide' id='carousel"+i+"'><div class='carousel-inner'>");
          $(".carousel", this).append('<a class="left carousel-controls" href="#carousel'+i+'" data-slide="prev">‹</a>\n<a class="right carousel-controls" href="#carousel'+i+'" data-slide="next">›</a>')
        }
      })
      $('.carousel').carousel({
        'interval': false
      });
    });
    </script>
  </head>
  <body>
    <div id="site"><div id="canvas">
      <header>
        <div id="first"><a href="/">{{ site.title }}</a></div>
        <div id="second">{{ site.tagline }}</div>
        <div id="menu">
          <ul>
            {% if page.group != "navigation" %}
            <li class="thispage"><a href="\">Blog</a></li>
            {% else %}
            <li><a href="\">Blog</a></li>
            {% endif %}
            {% for node in site.pages %}{% if node.group == 'navigation' %}
            {% if node.title == page.title %}
            <li class="thispage"><a href="{{ node.url }}">{{ node.title }}</a></li>
            {% else %}
            <li><a href="{{ node.url }}">{{ node.title }}</a></li>
            {% endif %}
            {% endif %}{% endfor %}
          </ul>
          <div id="menudivider"></div>
        </div>
      </header>
      <div id="content">
        {{ content }}
      </div>
    </div></div>
    {% include JB/analytics %}
  </body>
</html>
